import{f as p,h as be,a,c as ft,t as f,s as vt}from"../chunks/zguDtZw-.js";import{o as Ce}from"../chunks/hybYrdok.js";import{p as $e,d as Ht,i as ye,t as Pt,a as Pe,$ as Ee,s as e,c as i,f as S,e as ut,b as Se,h as v,r as o,g as B,u as Z}from"../chunks/SIFgIYqZ.js";import{a as Ie,i as O,b as we}from"../chunks/D4OMRqmI.js";import{c as N}from"../chunks/BmbK19Nn.js";import{r as Jt,c as Qt}from"../chunks/CCdH-GF7.js";import{e as ke,L as De}from"../chunks/C4qL6Mf1.js";import{C as Xt}from"../chunks/BUTdIsFV.js";import{a as Zt,b as te,C as ee}from"../chunks/B9HEA4Xl.js";import{C as ae}from"../chunks/B5ui7ZgY.js";import{B as tt}from"../chunks/DsjzulNM.js";import{I as nt}from"../chunks/87Ty6o0e.js";import{S as se}from"../chunks/bJ_I8NpF.js";import{s as re,u as Oe,a as it}from"../chunks/DGZIYs0n.js";import{D as Ue,a as Ae,b as ze,c as Te,R as Le}from"../chunks/UVnX9grY.js";import{L as ct}from"../chunks/DUYgD2_s.js";import{t as Et}from"../chunks/BJCWvCOq.js";import"../chunks/CWlk9DSI.js";import{i as Re}from"../chunks/CGNubMbN.js";import{h as Be,t as Ne}from"../chunks/CHemGuYG.js";import{R as Ve}from"../chunks/B877H2_W.js";import{S as Me}from"../chunks/BKkfcLAR.js";import{D as Fe}from"../chunks/BNz4MoZq.js";import{K as je}from"../chunks/L2MC0XWs.js";import{T as ie}from"../chunks/BHXAfpfV.js";import{I as oe}from"../chunks/amUgki5J.js";var qe=p("<!> Saving...",1),Ke=p("<!> Save Settings",1),We=p('<div class="flex items-center gap-2"><div class="bg-indigo-500/10 p-2 rounded-full"><!></div> <div><!> <!></div></div>'),Ye=p('<span class="text-xs text-muted-foreground">(Forced ON by environment)</span>'),Ge=p("<!> OIDC is forced ON, but critical server settings are missing. Click for details.",1),He=p("<!> OIDC is configured on server. View Status.",1),Je=p("<!> OIDC configured via application settings. Click to Manage Them.",1),Qe=p("<!> OIDC application settings not configured. Click to configure.",1),Xe=p('<div class="space-y-4"><div class="flex items-center justify-between rounded-lg border p-4 bg-muted/30"><div class="space-y-0.5"><label for="localAuthSwitch" class="text-base font-medium">Local Authentication</label> <p class="text-sm text-muted-foreground">Username and password stored in the system</p> <p class="text-xs text-muted-foreground mt-1">This is recommended to be enabled as a fallback option if OIDC authentication is unavailable.</p></div> <!></div> <div class="flex items-center justify-between rounded-lg border p-4 bg-muted/30"><div class="space-y-0.5"><label for="oidcAuthSwitch" class="text-base font-medium">OIDC Authentication</label> <p class="text-sm text-muted-foreground">Use an External OIDC Provider <!></p> <!></div> <!></div></div>'),Ze=p("<!> <!>",1),ta=p('<li><strong>Client ID:</strong> </li> <li><strong>Client Secret:</strong> <span class="italic text-muted-foreground">(Sensitive - Not Displayed)</span></li> <li><strong>Redirect URI:</strong> </li> <li><strong>Authorization Endpoint:</strong> </li> <li><strong>Token Endpoint:</strong> </li> <li><strong>User Info Endpoint:</strong> </li> <li><strong>Scopes:</strong> </li>',1),ea=p('<li><span class="text-destructive">OIDC configuration details not found in settings.</span></li>'),aa=p(`OIDC authentication is configured using server-side environment variables. <!> <p class="mt-2">The following OIDC settings are loaded from the server environment:</p> <ul class="list-disc list-inside mt-1 text-xs space-y-1"><!></ul> <p class="mt-2 text-xs">Changes to these settings must be made in your server's environment configuration.</p>`,1),sa=p('<br/> <strong class="text-orange-600 text-xs mt-1 block">OIDC usage is currently forced ON by <code>PUBLIC_OIDC_ENABLED</code>, but critical server-side OIDC environment variables appear to be missing. Please configure them below and save, or ensure the corresponding server environment variables are set.</strong>',1),ra=p('<br/> <strong class="text-orange-600 text-xs mt-1 block">OIDC usage is currently forced ON by <code>PUBLIC_OIDC_ENABLED</code>.</strong>',1),ia=p("Configure the OIDC settings for your application. These settings will be saved and used for OIDC authentication. <!>",1),oa=p("<!> <!>",1),na=p('<div class="grid gap-4 py-4 max-h-[50vh] overflow-y-auto pr-2"><div class="grid grid-cols-4 items-center gap-4"><!> <!></div> <div class="grid grid-cols-4 items-center gap-4"><!> <!></div> <div class="grid grid-cols-4 items-center gap-4"><!> <!></div> <div class="grid grid-cols-4 items-center gap-4"><!> <!></div> <div class="grid grid-cols-4 items-center gap-4"><!> <!></div> <div class="grid grid-cols-4 items-center gap-4"><!> <!></div> <div class="grid grid-cols-4 items-center gap-4"><!> <!></div></div>'),da=p("<!> <!>",1),la=p("<!> <!> <!>",1),ca=p('<div class="flex items-center gap-2"><div class="bg-cyan-500/10 p-2 rounded-full"><!></div> <div><!> <!></div></div>'),va=p('<div class="space-y-4"><div class="space-y-2"><label for="sessionTimeout" class="text-sm font-medium">Session Timeout (minutes)</label> <!> <p class="text-xs text-muted-foreground">Time until inactive sessions are automatically logged out (15-1440 minutes)</p></div> <div class="space-y-2"><label for="passwordPolicy" class="text-sm font-medium">Password Policy</label> <div class="grid grid-cols-3 gap-2"><!> <!> <!></div> <input type="hidden" id="passwordPolicy" name="passwordPolicy"/> <p class="text-xs text-muted-foreground mt-1"><!></p></div></div>'),ua=p("<!> <!>",1),ga=p('<div class="space-y-6"><div class="flex flex-col sm:flex-row justify-between sm:items-center gap-4"><div><h1 class="text-3xl font-bold tracking-tight">Security Settings</h1> <p class="text-sm text-muted-foreground mt-1">Configure authentication methods and security policies</p></div> <!></div> <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><!> <!> <div class="space-y-6"><!></div></div> <input type="hidden" id="csrf_token"/></div>');function Va(ne,n){var Dt,Ot,Ut,At,zt,Tt,Lt,Rt,Bt,Nt,Vt,Mt,Ft,jt,qt,Kt,Wt,Yt;$e(n,!0);const[de,le]=Ie(),V=()=>we(it,"$settingsStore",de),et=ke.PUBLIC_OIDC_ENABLED==="true";let ot=Se(!1),x=Ht({clientId:((Ut=(Ot=(Dt=n.data.settings)==null?void 0:Dt.auth)==null?void 0:Ot.oidc)==null?void 0:Ut.clientId)||"",clientSecret:"",redirectUri:((Tt=(zt=(At=n.data.settings)==null?void 0:At.auth)==null?void 0:zt.oidc)==null?void 0:Tt.redirectUri)||"http://localhost:3000/auth/oidc/callback",authorizationEndpoint:((Bt=(Rt=(Lt=n.data.settings)==null?void 0:Lt.auth)==null?void 0:Rt.oidc)==null?void 0:Bt.authorizationEndpoint)||"",tokenEndpoint:((Mt=(Vt=(Nt=n.data.settings)==null?void 0:Nt.auth)==null?void 0:Vt.oidc)==null?void 0:Mt.tokenEndpoint)||"",userinfoEndpoint:((qt=(jt=(Ft=n.data.settings)==null?void 0:Ft.auth)==null?void 0:jt.oidc)==null?void 0:qt.userinfoEndpoint)||"",scopes:((Yt=(Wt=(Kt=n.data.settings)==null?void 0:Kt.auth)==null?void 0:Wt.oidc)==null?void 0:Yt.scopes)||"openid email profile"}),gt=Ht({saving:!1}),pt=Z(()=>n.data.oidcEnvVarsConfigured),ce=Z(()=>{var l,U,M,dt,q,W,F,I,T,G,at,b;return!!((M=(U=(l=n.data.settings)==null?void 0:l.auth)==null?void 0:U.oidc)!=null&&M.clientId&&((W=(q=(dt=n.data.settings)==null?void 0:dt.auth)==null?void 0:q.oidc)!=null&&W.redirectUri)&&((T=(I=(F=n.data.settings)==null?void 0:F.auth)==null?void 0:I.oidc)!=null&&T.authorizationEndpoint)&&((b=(at=(G=n.data.settings)==null?void 0:G.auth)==null?void 0:at.oidc)!=null&&b.tokenEndpoint))});ye(()=>{n.data.settings&&Oe(n.data.settings)}),Ce(()=>{var l;et&&((l=V().auth)!=null&&l.oidcEnabled||it.update(U=>({...U,auth:{...U.auth||{},oidcEnabled:!0}})),n.data.oidcEnvVarsConfigured||ut(ot,!0))});function ve(l){it.update(U=>({...U,auth:{...U.auth||{},oidcEnabled:l}})),l&&!n.data.oidcEnvVarsConfigured&&ut(ot,!0)}function _t(){ut(ot,!0)}async function ue(){try{it.update(l=>{const U={...l.auth||{}},M={clientId:x.clientId,clientSecret:x.clientSecret,redirectUri:x.redirectUri,authorizationEndpoint:x.authorizationEndpoint,tokenEndpoint:x.tokenEndpoint,userinfoEndpoint:x.userinfoEndpoint,scopes:x.scopes};return{...l,auth:{...U,oidcEnabled:!0,oidc:M}}}),await re(),Et.success("OIDC configuration saved successfully."),ut(ot,!1)}catch(l){console.error("Failed to save OIDC configuration:",l),Et.error("Failed to save OIDC configuration.",{description:l instanceof Error?l.message:"An unknown error occurred."})}}async function ge(){gt.saving||(gt.saving=!0,Be({result:await Ne(re()),message:"Error Saving Settings",setLoadingState:l=>gt.saving=l,onSuccess:async()=>{Et.success("Settings Saved Successfully"),await Re()}}))}var mt=ga();be(l=>{Ee.title="Security Settings - Arcane"});var xt=i(mt),fe=e(i(xt),2);tt(fe,{onclick:ge,get disabled(){return gt.saving},class:"h-10 arcane-button-save",children:(l,U)=>{var M=ft(),dt=S(M);{var q=F=>{var I=qe(),T=S(I);Ve(T,{class:"animate-spin size-4"}),v(),a(F,I)},W=F=>{var I=Ke(),T=S(I);Me(T,{class:"size-4"}),v(),a(F,I)};O(dt,F=>{gt.saving?F(q):F(W,!1)})}a(l,M)},$$slots:{default:!0}}),o(xt);var bt=e(xt,2),St=i(bt);N(St,()=>Xt,(l,U)=>{U(l,{class:"border shadow-sm",children:(M,dt)=>{var q=Ze(),W=S(q);N(W,()=>Zt,(I,T)=>{T(I,{class:"pb-3",children:(G,at)=>{var b=We(),w=i(b),st=i(w);De(st,{class:"text-indigo-500 size-5"}),o(w);var H=e(w,2),$=i(H);N($,()=>te,(_,L)=>{L(_,{children:(P,k)=>{v();var D=f("Authentication Methods");a(P,D)},$$slots:{default:!0}})});var y=e($,2);N(y,()=>ae,(_,L)=>{L(_,{children:(P,k)=>{v();var D=f("Configure how users sign in");a(P,D)},$$slots:{default:!0}})}),o(H),o(b),a(G,b)},$$slots:{default:!0}})});var F=e(W,2);N(F,()=>ee,(I,T)=>{T(I,{children:(G,at)=>{var b=Xe(),w=i(b),st=e(i(w),2);const H=Z(()=>{var d;return((d=V().auth)==null?void 0:d.localAuthEnabled)??!0});se(st,{id:"localAuthSwitch",get checked(){return B(H)},onCheckedChange:d=>{it.update(E=>({...E,auth:{...E.auth||{},localAuthEnabled:d}}))}}),o(w);var $=e(w,2),y=i($),_=e(i(y),2),L=e(i(_));{var P=d=>{var E=Ye();a(d,E)};O(L,d=>{et&&d(P)})}o(_);var k=e(_,2);{var D=d=>{var E=ft(),z=S(E);{var Q=R=>{tt(R,{variant:"link",class:"p-0 h-auto text-xs text-destructive hover:underline",onclick:_t,children:(h,t)=>{var u=Ge(),c=S(u);ie(c,{class:"mr-1 size-3"}),v(),a(h,u)},$$slots:{default:!0}})},rt=(R,h)=>{{var t=c=>{tt(c,{variant:"link",class:"p-0 h-auto text-xs text-sky-600 hover:underline",onclick:_t,children:(X,m)=>{var C=He(),j=S(C);oe(j,{class:"mr-1 size-3"}),v(),a(X,C)},$$slots:{default:!0}})},u=(c,X)=>{{var m=j=>{tt(j,{variant:"link",class:"p-0 h-auto text-xs text-sky-600 hover:underline",onclick:_t,children:(s,g)=>{var r=Je(),Y=S(r);oe(Y,{class:"mr-1 size-3"}),v(),a(s,r)},$$slots:{default:!0}})},C=(j,s)=>{{var g=r=>{tt(r,{variant:"link",class:"p-0 h-auto text-xs text-destructive hover:underline",onclick:_t,children:(Y,ht)=>{var K=Qe(),lt=S(K);ie(lt,{class:"mr-1 size-3"}),v(),a(Y,K)},$$slots:{default:!0}})};O(j,r=>{B(ot)||r(g)},s)}};O(c,j=>{B(ce)?j(m):j(C,!1)},X)}};O(R,c=>{n.data.oidcEnvVarsConfigured?c(t):c(u,!1)},h)}};O(z,R=>{et&&!n.data.oidcEnvVarsConfigured?R(Q):R(rt,!1)})}a(d,E)};O(k,d=>{var E;(et||(E=V().auth)!=null&&E.oidcEnabled)&&d(D)})}o(y);var J=e(y,2);const A=Z(()=>{var d;return et||(((d=V().auth)==null?void 0:d.oidcEnabled)??!1)});se(J,{id:"oidcAuthSwitch",get checked(){return B(A)},get disabled(){return et},onCheckedChange:ve}),o($),o(b),a(G,b)},$$slots:{default:!0}})}),a(M,q)},$$slots:{default:!0}})});var It=e(St,2);N(It,()=>Le,(l,U)=>{U(l,{get open(){return B(ot)},set open(M){ut(ot,M,!0)},children:(M,dt)=>{var q=ft(),W=S(q);N(W,()=>Ue,(F,I)=>{I(F,{class:"sm:max-w-[600px]",children:(T,G)=>{var at=la(),b=S(at);N(b,()=>Ae,($,y)=>{y($,{children:(_,L)=>{var P=oa(),k=S(P);N(k,()=>ze,(J,A)=>{A(J,{children:(d,E)=>{var z=ft(),Q=S(z);{var rt=h=>{var t=f("OIDC Configuration Status");a(h,t)},R=h=>{var t=f("Configure OIDC Provider");a(h,t)};O(Q,h=>{B(pt)?h(rt):h(R,!1)})}a(d,z)},$$slots:{default:!0}})});var D=e(k,2);N(D,()=>Fe,(J,A)=>{A(J,{children:(d,E)=>{var z=ft(),Q=S(z);{var rt=h=>{var t=aa(),u=e(S(t));{var c=g=>{var r=f("It is currently active.");a(g,r)},X=(g,r)=>{{var Y=K=>{var lt=f("It is forced ON by environment variables but may require application settings to be saved if this is the first run.");a(K,lt)},ht=K=>{var lt=f("It is configured but currently disabled in application settings. You can enable it using the switch.");a(K,lt)};O(g,K=>{et?K(Y):K(ht,!1)},r)}};O(u,g=>{var r;(r=V().auth)!=null&&r.oidcEnabled?g(c):g(X,!1)})}var m=e(u,4),C=i(m);{var j=g=>{var r=ta(),Y=S(r),ht=e(i(Y));o(Y);var K=e(Y,4),lt=e(i(K));o(K);var Ct=e(K,2),_e=e(i(Ct));o(Ct);var $t=e(Ct,2),he=e(i($t));o($t);var yt=e($t,2),me=e(i(yt));o(yt);var Gt=e(yt,2),xe=e(i(Gt));o(Gt),Pt(()=>{vt(ht,` ${n.data.settings.auth.oidc.clientId??""}`),vt(lt,` ${n.data.settings.auth.oidc.redirectUri??""}`),vt(_e,` ${n.data.settings.auth.oidc.authorizationEndpoint??""}`),vt(he,` ${n.data.settings.auth.oidc.tokenEndpoint??""}`),vt(me,` ${n.data.settings.auth.oidc.userinfoEndpoint??""}`),vt(xe,` ${n.data.settings.auth.oidc.scopes??""}`)}),a(g,r)},s=g=>{var r=ea();a(g,r)};O(C,g=>{var r,Y;(Y=(r=n.data.settings)==null?void 0:r.auth)!=null&&Y.oidc?g(j):g(s,!1)})}o(m),v(2),a(h,t)},R=h=>{var t=ia(),u=e(S(t));{var c=m=>{var C=sa();v(2),a(m,C)},X=(m,C)=>{{var j=s=>{var g=ra();v(2),a(s,g)};O(m,s=>{et&&s(j)},C)}};O(u,m=>{et&&!n.data.oidcEnvVarsConfigured?m(c):m(X,!1)})}a(h,t)};O(Q,h=>{B(pt)?h(rt):h(R,!1)})}a(d,z)},$$slots:{default:!0}})}),a(_,P)},$$slots:{default:!0}})});var w=e(b,2);{var st=$=>{var y=na(),_=i(y),L=i(_);ct(L,{for:"oidcClientId",class:"text-right col-span-1",children:(s,g)=>{v();var r=f("Client ID");a(s,r)},$$slots:{default:!0}});var P=e(L,2);nt(P,{id:"oidcClientId",class:"col-span-3",placeholder:"Provided by your OIDC Provider",get value(){return x.clientId},set value(s){x.clientId=s}}),o(_);var k=e(_,2),D=i(k);ct(D,{for:"oidcClientSecret",class:"text-right col-span-1",children:(s,g)=>{v();var r=f("Client Secret");a(s,r)},$$slots:{default:!0}});var J=e(D,2);nt(J,{id:"oidcClientSecret",type:"password",class:"col-span-3",placeholder:"Provided by your OIDC Provider",get value(){return x.clientSecret},set value(s){x.clientSecret=s}}),o(k);var A=e(k,2),d=i(A);ct(d,{for:"oidcRedirectUri",class:"text-right col-span-1",children:(s,g)=>{v();var r=f("Redirect URI");a(s,r)},$$slots:{default:!0}});var E=e(d,2);nt(E,{id:"oidcRedirectUri",placeholder:"e.g., http://localhost:3000/auth/oidc/callback",class:"col-span-3",get value(){return x.redirectUri},set value(s){x.redirectUri=s}}),o(A);var z=e(A,2),Q=i(z);ct(Q,{for:"oidcAuthEndpoint",class:"text-right col-span-1",children:(s,g)=>{v();var r=f("Authorization URL");a(s,r)},$$slots:{default:!0}});var rt=e(Q,2);nt(rt,{id:"oidcAuthEndpoint",class:"col-span-3",placeholder:"OIDC Provider's Authorization Endpoint",get value(){return x.authorizationEndpoint},set value(s){x.authorizationEndpoint=s}}),o(z);var R=e(z,2),h=i(R);ct(h,{for:"oidcTokenEndpoint",class:"text-right col-span-1",children:(s,g)=>{v();var r=f("Token URL");a(s,r)},$$slots:{default:!0}});var t=e(h,2);nt(t,{id:"oidcTokenEndpoint",class:"col-span-3",placeholder:"OIDC Provider's Token Endpoint",get value(){return x.tokenEndpoint},set value(s){x.tokenEndpoint=s}}),o(R);var u=e(R,2),c=i(u);ct(c,{for:"oidcUserinfoEndpoint",class:"text-right col-span-1",children:(s,g)=>{v();var r=f("User Info URL");a(s,r)},$$slots:{default:!0}});var X=e(c,2);nt(X,{id:"oidcUserinfoEndpoint",class:"col-span-3",placeholder:"OIDC Provider's UserInfo Endpoint",get value(){return x.userinfoEndpoint},set value(s){x.userinfoEndpoint=s}}),o(u);var m=e(u,2),C=i(m);ct(C,{for:"oidcScopes",class:"text-right col-span-1",children:(s,g)=>{v();var r=f("Scopes");a(s,r)},$$slots:{default:!0}});var j=e(C,2);nt(j,{id:"oidcScopes",placeholder:"e.g., openid email profile",class:"col-span-3",get value(){return x.scopes},set value(s){x.scopes=s}}),o(m),o(y),a($,y)};O(w,$=>{B(pt)||$(st)})}var H=e(w,2);N(H,()=>Te,($,y)=>{y($,{children:(_,L)=>{var P=da(),k=S(P);tt(k,{variant:"outline",onclick:()=>ut(ot,!1),children:(A,d)=>{v();var E=f("Close");a(A,E)},$$slots:{default:!0}});var D=e(k,2);{var J=A=>{tt(A,{onclick:ue,children:(d,E)=>{v();var z=f("Save Configuration");a(d,z)},$$slots:{default:!0}})};O(D,A=>{B(pt)||A(J)})}a(_,P)},$$slots:{default:!0}})}),a(T,at)},$$slots:{default:!0}})}),a(M,q)},$$slots:{default:!0}})});var wt=e(It,2),pe=i(wt);N(pe,()=>Xt,(l,U)=>{U(l,{class:"border shadow-sm",children:(M,dt)=>{var q=ua(),W=S(q);N(W,()=>Zt,(I,T)=>{T(I,{class:"pb-3",children:(G,at)=>{var b=ca(),w=i(b),st=i(w);je(st,{class:"text-cyan-500 size-5"}),o(w);var H=e(w,2),$=i(H);N($,()=>te,(_,L)=>{L(_,{children:(P,k)=>{v();var D=f("Session Settings");a(P,D)},$$slots:{default:!0}})});var y=e($,2);N(y,()=>ae,(_,L)=>{L(_,{children:(P,k)=>{v();var D=f("Configure session behavior");a(P,D)},$$slots:{default:!0}})}),o(H),o(b),a(G,b)},$$slots:{default:!0}})});var F=e(W,2);N(F,()=>ee,(I,T)=>{T(I,{children:(G,at)=>{var b=va(),w=i(b),st=e(i(w),2);const H=Z(()=>{var t;return((t=V().auth)==null?void 0:t.sessionTimeout)??60});nt(st,{type:"number",id:"sessionTimeout",name:"sessionTimeout",get value(){return B(H)},min:"15",max:"1440",oninput:t=>{const u=t.target;it.update(c=>({...c,auth:{...c.auth??{},sessionTimeout:parseInt(u.value)}}))}}),v(2),o(w);var $=e(w,2),y=e(i($),2),_=i(y);const L=Z(()=>{var t;return(((t=V().auth)==null?void 0:t.passwordPolicy)||"strong")==="basic"?"default":"outline"}),P=Z(()=>{var t;return(((t=V().auth)==null?void 0:t.passwordPolicy)||"strong")==="basic"?"w-full arcane-button-create":"w-full arcane-button-restart"});tt(_,{get variant(){return B(L)},get class(){return B(P)},onclick:()=>{it.update(t=>({...t,auth:{...t.auth,passwordPolicy:"basic"}}))},children:(t,u)=>{v();var c=f("Basic");a(t,c)},$$slots:{default:!0}});var k=e(_,2);const D=Z(()=>{var t;return(((t=V().auth)==null?void 0:t.passwordPolicy)||"strong")==="standard"?"default":"outline"}),J=Z(()=>{var t;return(((t=V().auth)==null?void 0:t.passwordPolicy)||"strong")==="standard"?"w-full arcane-button-create":"w-full arcane-button-restart"});tt(k,{get variant(){return B(D)},get class(){return B(J)},onclick:()=>{it.update(t=>({...t,auth:{...t.auth,passwordPolicy:"standard"}}))},children:(t,u)=>{v();var c=f("Standard");a(t,c)},$$slots:{default:!0}});var A=e(k,2);const d=Z(()=>{var t;return(((t=V().auth)==null?void 0:t.passwordPolicy)||"strong")==="strong"?"default":"outline"}),E=Z(()=>{var t;return(((t=V().auth)==null?void 0:t.passwordPolicy)||"strong")==="strong"?"w-full arcane-button-create":"w-full arcane-button-restart"});tt(A,{get variant(){return B(d)},get class(){return B(E)},onclick:()=>{it.update(t=>({...t,auth:{...t.auth,passwordPolicy:"strong"}}))},children:(t,u)=>{v();var c=f("Strong");a(t,c)},$$slots:{default:!0}}),o(y);var z=e(y,2);Jt(z);var Q=e(z,2),rt=i(Q);{var R=t=>{var u=f("Basic: Minimum 8 characters");a(t,u)},h=(t,u)=>{{var c=m=>{var C=f("Standard: Minimum 10 characters, requires mixed case and numbers");a(m,C)},X=m=>{var C=f("Strong: Minimum 12 characters, requires mixed case, numbers and special characters");a(m,C)};O(t,m=>{var C;((C=V().auth)==null?void 0:C.passwordPolicy)==="standard"?m(c):m(X,!1)},u)}};O(rt,t=>{var u;((u=V().auth)==null?void 0:u.passwordPolicy)==="basic"?t(R):t(h,!1)})}o(Q),o($),o(b),Pt(()=>{var t;return Qt(z,((t=V().auth)==null?void 0:t.passwordPolicy)||"strong")}),a(G,b)},$$slots:{default:!0}})}),a(M,q)},$$slots:{default:!0}})}),o(wt),o(bt);var kt=e(bt,2);Jt(kt),o(mt),Pt(()=>Qt(kt,n.data.csrf)),a(ne,mt),Pe(),le()}export{Va as component};
