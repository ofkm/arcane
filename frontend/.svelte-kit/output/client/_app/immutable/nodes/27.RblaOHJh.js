import{c as S,a as e,f as d,t as z,s as me,e as pr,h as _r}from"../chunks/zguDtZw-.js";import{p as Ie,f as s,n as Qe,a as Le,i as dr,e as v,b as fe,h as $,t as pe,g as r,u as U,s as o,c as x,r as h,d as tr,$ as $r}from"../chunks/SIFgIYqZ.js";import{s as Xe,r as Ye,p as Pe,i as Ae}from"../chunks/D4OMRqmI.js";import{I as Ze,s as er,e as cr}from"../chunks/CCdH-GF7.js";import{c as l}from"../chunks/BmbK19Nn.js";import{b as gr}from"../chunks/C7TZ37ch.js";import{C as hr}from"../chunks/BUTdIsFV.js";import{a as xr,b as yr,C as br}from"../chunks/B9HEA4Xl.js";import{C as Pr}from"../chunks/B5ui7ZgY.js";import{B as qe}from"../chunks/DsjzulNM.js";import{t as sr}from"../chunks/BJCWvCOq.js";import"../chunks/CWlk9DSI.js";import{U as Ur,T as Ne,E as Sr}from"../chunks/D2ZQhq98.js";import{D as wr,a as Dr,b as Er,c as Cr,R as Tr}from"../chunks/UVnX9grY.js";import{I as Ge}from"../chunks/87Ty6o0e.js";import{L as Re}from"../chunks/DUYgD2_s.js";import{R as Nr,S as Rr,a as Ar,G as Ir,b as Lr}from"../chunks/C73rBIzk.js";import{p as kr}from"../chunks/B1ASiaS-.js";import{L as zr}from"../chunks/BjTWgG3-.js";import{D as Mr}from"../chunks/BNz4MoZq.js";import{S as Or}from"../chunks/BKkfcLAR.js";import{R as Br,T as Kr,D as jr,G as Gr}from"../chunks/CNwxKbLf.js";import{h as ar,t as or}from"../chunks/CHemGuYG.js";import{B as qr}from"../chunks/CThrnvRT.js";import{i as lr}from"../chunks/CGNubMbN.js";import{o as Hr}from"../chunks/BUdkjQ9d.js";import{S as nr}from"../chunks/mAxAJ61f.js";import{D as ir}from"../chunks/CuZ1HGtB.js";import{P as Fr}from"../chunks/CtVgMZPJ.js";function Vr(K,a){Ie(a,!0);let f=Ye(a,["$$slots","$$events","$$legacy"]);const n=[["path",{d:"m16 11 2 2 4-4"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}],["circle",{cx:"9",cy:"7",r:"4"}]];Ze(K,Xe({name:"user-check"},()=>f,{get iconNode(){return n},children:(y,j)=>{var R=S(),V=s(R);er(V,()=>a.children??Qe),e(y,R)},$$slots:{default:!0}})),Le()}function ur(K,a){Ie(a,!0);let f=Ye(a,["$$slots","$$events","$$legacy"]);const n=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}],["circle",{cx:"9",cy:"7",r:"4"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11"}]];Ze(K,Xe({name:"user-plus"},()=>f,{get iconNode(){return n},children:(y,j)=>{var R=S(),V=s(R);er(V,()=>a.children??Qe),e(y,R)},$$slots:{default:!0}})),Le()}function Wr(K,a){Ie(a,!0);let f=Ye(a,["$$slots","$$events","$$legacy"]);const n=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}],["circle",{cx:"9",cy:"7",r:"4"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13"}]];Ze(K,Xe({name:"user-x"},()=>f,{get iconNode(){return n},children:(y,j)=>{var R=S(),V=s(R);er(V,()=>a.children??Qe),e(y,R)},$$slots:{default:!0}})),Le()}var Jr=d("<!> <!>",1),Qr=d("<span> </span>"),Xr=d("<!> <!>",1),Yr=d('<p class="text-sm text-destructive text-center col-span-4"> </p>'),Zr=d("<!> Creating...",1),et=d("<!> ",1),rt=d("<!> <!>",1),tt=d('<!> <form class="grid gap-4 py-4" autocomplete="off"><div class="grid grid-cols-4 items-center gap-4"><!> <!></div> <div class="grid grid-cols-4 items-center gap-4"><!> <!></div> <div class="grid grid-cols-4 items-center gap-4"><!> <!></div> <div class="grid grid-cols-4 items-center gap-4"><!> <!></div> <div class="grid grid-cols-4 items-center gap-4"><!> <!></div> <!> <!></form>',1);function st(K,a){Ie(a,!0);let f=Pe(a,"open",15,!1),n=Pe(a,"userToEdit",11,null),y=Pe(a,"roles",19,()=>[]),j=Pe(a,"isLoading",11,!1),R=Pe(a,"onSubmit",11,()=>{}),V=Pe(a,"allowUsernameEdit",3,!1),le=fe(""),Y=fe(""),ne=fe(""),Z=fe(""),W=fe("user"),ee=fe(null),w=U(()=>!!n()),He=U(()=>r(w)?"Edit User":"Create User"),p=U(()=>r(w)?"Save Changes":"Create User"),J=U(()=>r(w)?Or:ur),Ue=U(()=>!r(w)||V());dr(()=>{var Q;f()&&(v(ee,null),n()?(v(le,n().username,!0),v(Y,""),v(ne,n().displayName||"",!0),v(Z,n().email||"",!0),v(W,((Q=n().roles)==null?void 0:Q[0])||"admin",!0)):(v(le,""),v(Y,""),v(ne,""),v(Z,""),v(W,"admin")))});async function ke(){var re;if(j())return;v(ee,null);const Q={username:r(le),displayName:r(ne),email:r(Z),roles:[r(W)]};(!r(w)||r(w)&&r(Y))&&(Q.password=r(Y));try{R()({user:Q,isEditMode:r(w),userId:(re=n())==null?void 0:re.id})}catch(G){const _e=G instanceof Error?G.message:"An unexpected error occurred.";v(ee,_e,!0)}}var Se=S(),ze=s(Se);l(ze,()=>Tr,(Q,re)=>{re(Q,{get open(){return f()},set open(G){f(G)},children:(G,_e)=>{var Me=S(),ie=s(Me);l(ie,()=>wr,(de,ce)=>{ce(de,{class:"sm:max-w-[425px]",children:(we,q)=>{var M=tt(),$e=s(M);l($e,()=>Dr,(t,c)=>{c(t,{children:(i,je)=>{var E=Jr(),B=s(E);l(B,()=>Er,(T,b)=>{b(T,{children:(F,P)=>{$();var k=z();pe(()=>me(k,r(He))),e(F,k)},$$slots:{default:!0}})});var H=o(B,2);{var C=T=>{var b=S(),F=s(b);l(F,()=>Mr,(P,k)=>{k(P,{children:(_,g)=>{$();var N=z("Enter the details for the new user.");e(_,N)},$$slots:{default:!0}})}),e(T,b)};Ae(H,T=>{r(w)||T(C)})}e(i,E)},$$slots:{default:!0}})});var ge=o($e,2),X=U(()=>kr(ke)),A=x(ge),m=x(A);Re(m,{for:"username",class:"text-right",children:(t,c)=>{$();var i=z("Username");e(t,i)},$$slots:{default:!0}});var te=o(m,2);const se=U(()=>!r(Ue));Ge(te,{autocomplete:"off",id:"username",required:!0,class:"col-span-3",get disabled(){return r(se)},get value(){return r(le)},set value(t){v(le,t,!0)}}),h(A);var he=o(A,2),De=x(he);Re(De,{for:"password",class:"text-right",children:(t,c)=>{$();var i=z("Password");e(t,i)},$$slots:{default:!0}});var Oe=o(De,2);const Fe=U(()=>!r(w)),O=U(()=>r(w)?"Leave blank to keep current":"Required");Ge(Oe,{autocomplete:"off",id:"password",type:"password",get required(){return r(Fe)},get placeholder(){return r(O)},class:"col-span-3",get value(){return r(Y)},set value(t){v(Y,t,!0)}}),h(he);var D=o(he,2),I=x(D);Re(I,{for:"displayName",class:"text-right",children:(t,c)=>{$();var i=z("Display Name");e(t,i)},$$slots:{default:!0}});var xe=o(I,2);Ge(xe,{autocomplete:"off",id:"displayName",class:"col-span-3",get value(){return r(ne)},set value(t){v(ne,t,!0)}}),h(D);var u=o(D,2),L=x(u);Re(L,{for:"email",class:"text-right",children:(t,c)=>{$();var i=z("Email");e(t,i)},$$slots:{default:!0}});var Ee=o(L,2);Ge(Ee,{autocomplete:"off",id:"email",type:"email",class:"col-span-3",get value(){return r(Z)},set value(t){v(Z,t,!0)}}),h(u);var ae=o(u,2),ye=x(ae);Re(ye,{for:"role",class:"text-right",children:(t,c)=>{$();var i=z("Role");e(t,i)},$$slots:{default:!0}});var Be=o(ye,2);l(Be,()=>Nr,(t,c)=>{c(t,{name:"role",type:"single",disabled:!0,get value(){return r(W)},set value(i){v(W,i,!0)},children:(i,je)=>{var E=Xr(),B=s(E);l(B,()=>Rr,(C,T)=>{T(C,{class:"col-span-3",children:(b,F)=>{var P=Qr(),k=x(P,!0);h(P),pe(_=>me(k,_),[()=>{var _;return((_=y().find(g=>g.id===r(W)))==null?void 0:_.name)||"Select a role"}]),e(b,P)},$$slots:{default:!0}})});var H=o(B,2);l(H,()=>Ar,(C,T)=>{T(C,{children:(b,F)=>{var P=S(),k=s(P);l(k,()=>Ir,(_,g)=>{g(_,{children:(N,be)=>{var ue=S(),oe=s(ue);cr(oe,17,y,ve=>ve.id,(ve,We)=>{var Te=S(),Je=s(Te);l(Je,()=>Lr,(vr,fr)=>{fr(vr,{get value(){return r(We).id},children:(mr,ht)=>{$();var rr=z();pe(()=>me(rr,r(We).name)),e(mr,rr)},$$slots:{default:!0}})}),e(ve,Te)}),e(N,ue)},$$slots:{default:!0}})}),e(b,P)},$$slots:{default:!0}})}),e(i,E)},$$slots:{default:!0}})}),h(ae);var Ce=o(ae,2);{var Ke=t=>{var c=Yr(),i=x(c,!0);h(c),pe(()=>me(i,r(ee))),e(t,c)};Ae(Ce,t=>{r(ee)&&t(Ke)})}var Ve=o(Ce,2);l(Ve,()=>Cr,(t,c)=>{c(t,{children:(i,je)=>{var E=rt(),B=s(E);qe(B,{type:"button",class:"arcane-button-cancel",variant:"outline",onclick:()=>f(!1),get disabled(){return j()},children:(C,T)=>{$();var b=z("Cancel");e(C,b)},$$slots:{default:!0}});var H=o(B,2);qe(H,{type:"submit",class:"arcane-button-create",get disabled(){return j()},children:(C,T)=>{var b=S(),F=s(b);{var P=_=>{var g=Zr(),N=s(g);zr(N,{class:"animate-spin size-4"}),$(),e(_,g)},k=_=>{var g=et(),N=s(g);l(N,()=>r(J),(ue,oe)=>{oe(ue,{class:"size-4"})});var be=o(N);pe(()=>me(be,` ${r(p)??""}`)),e(_,g)};Ae(F,_=>{j()?_(P):_(k,!1)})}e(C,b)},$$slots:{default:!0}}),e(i,E)},$$slots:{default:!0}})}),h(ge),pr("submit",ge,function(...t){var c;(c=r(X))==null||c.apply(this,t)}),e(we,M)},$$slots:{default:!0}})}),e(G,Me)},$$slots:{default:!0}})}),e(K,Se),Le()}class at extends qr{async update(a,f){return(await this.api.put(`/users/${a}`,f)).data}async create(a){return(await this.api.post("/users",a)).data}async delete(a){return(await this.api.delete(`/users/${a}`)).data}}var ot=d("<!> Create User",1),lt=d('<div class="flex items-center gap-2"><div class="bg-blue-500/10 p-2 rounded-full"><!></div> <div><!> <!></div></div> <!>',1),nt=d('<div class="flex items-center gap-1.5"> </div>'),it=d('<div class="flex flex-wrap"></div>'),dt=d('<!> <span class="sr-only">Open menu</span>',1),ct=d("<!> Edit",1),ut=d("<!> Remove User",1),vt=d("<!> <!>",1),ft=d("<!> <!>",1),mt=d("<!> <!> <!> <!> <!>",1),pt=d('<div class="flex-1 flex flex-col h-full"><!></div>'),_t=d('<div class="text-center py-8 text-muted-foreground italic">No local users found</div>'),$t=d("<!> <!>",1),gt=d('<!> <div class="space-y-6"><div><h1 class="text-3xl font-bold tracking-tight">User Management</h1> <p class="text-sm text-muted-foreground mt-1">Manage user accounts and permissions</p></div> <div class="grid grid-cols-1 gap-6 h-full"><!></div></div>',1);function Jt(K,a){Ie(a,!0);const f=new at;let n=tr({users:a.data.users,isUserDialogOpen:!1,userToEdit:null}),y=tr({saving:!1}),j=fe(null);dr(()=>{n.users=a.data.users});const R=[{id:"admin",name:"Administrator"},{id:"user",name:"Standard User"},{id:"viewer",name:"Viewer (read-only)"}];function V(){n.userToEdit=null,n.isUserDialogOpen=!0}function le(p){n.userToEdit=p,n.isUserDialogOpen=!0}async function Y({user:p,isEditMode:J,userId:Ue}){y.saving=!0,ar({result:await or(J?f.update(Ue||"",p):f.create(p)),message:J?"Error Updating User":"Error Creating User",setLoadingState:ke=>y.saving=ke,onSuccess:async()=>{n.isUserDialogOpen=!1,sr.success(J?"User Updated Successfully":"User Created Successfully"),await lr(),y.saving=!1}})}async function ne(p){Hr({title:"Delete User",message:"Are you sure you want to delete this user? This action cannot be undone.",confirm:{label:"Delete",destructive:!0,action:async()=>{ar({result:await or(f.delete(p)),message:"Failed to Delete User",setLoadingState:J=>y.saving=J,onSuccess:async()=>{sr.success("User Deleted Successfully."),await lr()}})}}})}var Z=gt();_r(p=>{$r.title="User Management - Arcane"});var W=s(Z);gr(st(W,{get roles(){return R},onSubmit:Y,get isLoading(){return y.saving},allowUsernameEdit:!0,get open(){return n.isUserDialogOpen},set open(p){n.isUserDialogOpen=p},get userToEdit(){return n.userToEdit},set userToEdit(p){n.userToEdit=p}}),p=>v(j,p,!0),()=>r(j));var ee=o(W,2),w=o(x(ee),2),He=x(w);l(He,()=>hr,(p,J)=>{J(p,{class:"border shadow-sm flex flex-col",children:(Ue,ke)=>{var Se=$t(),ze=s(Se);l(ze,()=>xr,(re,G)=>{G(re,{class:"pb-3 flex flex-row items-center justify-between space-y-0",children:(_e,Me)=>{var ie=lt(),de=s(ie),ce=x(de),we=x(ce);Vr(we,{class:"text-blue-500 size-5"}),h(ce);var q=o(ce,2),M=x(q);l(M,()=>yr,(X,A)=>{A(X,{children:(m,te)=>{$();var se=z("User Accounts");e(m,se)},$$slots:{default:!0}})});var $e=o(M,2);l($e,()=>Pr,(X,A)=>{A(X,{children:(m,te)=>{$();var se=z("Manage local user accounts");e(m,se)},$$slots:{default:!0}})}),h(q),h(de);var ge=o(de,2);qe(ge,{class:"arcane-button-save",onclick:V,children:(X,A)=>{var m=ot(),te=s(m);ur(te,{class:"size-4"}),$(),e(X,m)},$$slots:{default:!0}}),e(_e,ie)},$$slots:{default:!0}})});var Q=o(ze,2);l(Q,()=>br,(re,G)=>{G(re,{class:"flex-1 flex flex-col",children:(_e,Me)=>{var ie=S(),de=s(ie);{var ce=q=>{var M=pt(),$e=x(M);Ur($e,{get data(){return n.users},columns:[{accessorKey:"user",header:"User"},{accessorKey:"email",header:"Email"},{accessorKey:"roles",header:"Roles"},{accessorKey:"source",header:"Source",enableSorting:!1},{accessorKey:"actions",header:" "}],features:{sorting:!0,filtering:!0,selection:!1},pagination:{pageSize:10,pageSizeOptions:[5,10,15,20]},display:{filterPlaceholder:"Filter users...",noResultsMessage:"No users found"},sort:{defaultSort:{id:"user",desc:!1}},rows:(X,A)=>{let m=()=>A==null?void 0:A().item;var te=mt(),se=s(te);l(se,()=>Ne,(O,D)=>{D(O,{children:(I,xe)=>{$();var u=z();pe(()=>me(u,m().displayName)),e(I,u)},$$slots:{default:!0}})});var he=o(se,2);l(he,()=>Ne,(O,D)=>{D(O,{children:(I,xe)=>{var u=nt(),L=x(u,!0);h(u),pe(()=>me(L,m().email)),e(I,u)},$$slots:{default:!0}})});var De=o(he,2);l(De,()=>Ne,(O,D)=>{D(O,{children:(I,xe)=>{var u=it();cr(u,20,()=>m().roles,L=>L,(L,Ee)=>{const ae=U(()=>Ee==="admin"),ye=U(()=>r(ae)?"Admin":"User"),Be=U(()=>r(ae)?"amber":"blue");nr(L,{get text(){return r(ye)},get variant(){return r(Be)}})}),h(u),e(I,u)},$$slots:{default:!0}})});var Oe=o(De,2);l(Oe,()=>Ne,(O,D)=>{D(O,{children:(I,xe)=>{const u=U(()=>m().oidcSubjectId?"OIDC":"Local"),L=U(()=>m().oidcSubjectId?"blue":"purple");nr(I,{get text(){return r(u)},get variant(){return r(L)}})},$$slots:{default:!0}})});var Fe=o(Oe,2);l(Fe,()=>Ne,(O,D)=>{D(O,{children:(I,xe)=>{var u=S(),L=s(u);l(L,()=>Br,(Ee,ae)=>{ae(Ee,{children:(ye,Be)=>{var Ce=ft(),Ke=s(Ce);l(Ke,()=>Kr,(t,c)=>{c(t,{children:(i,je)=>{qe(i,{variant:"ghost",size:"icon",class:"size-8",children:(E,B)=>{var H=dt(),C=s(H);Sr(C,{class:"size-4"}),$(2),e(E,H)},$$slots:{default:!0}})},$$slots:{default:!0}})});var Ve=o(Ke,2);l(Ve,()=>jr,(t,c)=>{c(t,{align:"end",children:(i,je)=>{var E=S(),B=s(E);l(B,()=>Gr,(H,C)=>{C(H,{children:(T,b)=>{var F=vt(),P=s(F);{var k=g=>{var N=S(),be=s(N);l(be,()=>ir,(ue,oe)=>{oe(ue,{onclick:()=>le(m()),children:(ve,We)=>{var Te=ct(),Je=s(Te);Fr(Je,{class:"size-4"}),$(),e(ve,Te)},$$slots:{default:!0}})}),e(g,N)};Ae(P,g=>{m().oidcSubjectId||g(k)})}var _=o(P,2);l(_,()=>ir,(g,N)=>{N(g,{class:"text-red-500 focus:text-red-700!",onclick:()=>ne(m().id),children:(be,ue)=>{var oe=ut(),ve=s(oe);Wr(ve,{class:"size-4"}),$(),e(be,oe)},$$slots:{default:!0}})}),e(T,F)},$$slots:{default:!0}})}),e(i,E)},$$slots:{default:!0}})}),e(ye,Ce)},$$slots:{default:!0}})}),e(I,u)},$$slots:{default:!0}})}),e(X,te)},$$slots:{rows:!0}}),h(M),e(q,M)},we=q=>{var M=_t();e(q,M)};Ae(de,q=>{n.users.length>0?q(ce):q(we,!1)})}e(_e,ie)},$$slots:{default:!0}})}),e(Ue,Se)},$$slots:{default:!0}})}),h(w),h(ee),e(K,Z),Le()}export{Jt as component};
