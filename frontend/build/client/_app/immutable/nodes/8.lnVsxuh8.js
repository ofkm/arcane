import{c as O,a as t,f as c,s as me,t as Xe}from"../chunks/zguDtZw-.js";import{p as bt,f as n,n as Ht,a as Pt,d as ls,s as i,c as h,r as y,t as he,g as r,u as S,h as z,b as At,e as Oe}from"../chunks/SIFgIYqZ.js";import{s as dt,r as Wt,i as x}from"../chunks/D4OMRqmI.js";import{c as l}from"../chunks/BmbK19Nn.js";import{I as Nt,s as Qt,b as Lt}from"../chunks/CCdH-GF7.js";import{C as it}from"../chunks/BUTdIsFV.js";import{C as ct,a as is,b as cs}from"../chunks/B9HEA4Xl.js";import{B as yt}from"../chunks/DsjzulNM.js";import{U as ds,T as Me,E as Ft}from"../chunks/D2ZQhq98.js";import{o as Tt}from"../chunks/BUdkjQ9d.js";import{R as Et,T as It,D as Dt,G as Ot}from"../chunks/CNwxKbLf.js";import{A as us}from"../chunks/m9ItHG6J.js";import{A as ms,a as vs}from"../chunks/iMjrFJrG.js";import{g as Ye,i as ie}from"../chunks/CGNubMbN.js";import{S as Mt}from"../chunks/mAxAJ61f.js";import{c as ps}from"../chunks/DVaDWjV4.js";import{s as fs}from"../chunks/CXuQMvfN.js";import{t as R}from"../chunks/BJCWvCOq.js";import"../chunks/CWlk9DSI.js";import{t as ke,h as Ae}from"../chunks/CHemGuYG.js";import{S as _s}from"../chunks/TMHAhBh7.js";import{A as xt,R as kt}from"../chunks/DJtaXGK5.js";import{t as Ut}from"../chunks/BXZ-8GCb.js";import{F as Kt}from"../chunks/C5X3i-BG.js";import{L as Vt}from"../chunks/0Kkvs01K.js";import{L as ve}from"../chunks/BjTWgG3-.js";import{C as wt}from"../chunks/CX4OS9M0.js";import{D as X}from"../chunks/CuZ1HGtB.js";import{D as St}from"../chunks/CdIEgevt.js";import{T as Jt}from"../chunks/BhZTThSR.js";import{P as qt}from"../chunks/CWU1czEL.js";import{C as Bt}from"../chunks/Co9IQC3A.js";function Gt(we,M){bt(M,!0);let Ue=Wt(M,["$$slots","$$events","$$legacy"]);const Se=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"}]];Nt(we,dt({name:"pen"},()=>Ue,{get iconNode(){return Se},children:(pe,$)=>{var se=O(),Y=n(se);Qt(Y,()=>M.children??Ht),t(pe,se)},$$slots:{default:!0}})),Pt()}function gs(we,M){bt(M,!0);let Ue=Wt(M,["$$slots","$$events","$$legacy"]);const Se=[["path",{d:"M12.034 12.681a.498.498 0 0 1 .647-.647l9 3.5a.5.5 0 0 1-.033.943l-3.444 1.068a1 1 0 0 0-.66.66l-1.067 3.443a.5.5 0 0 1-.943.033z"}],["path",{d:"M21 11V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h6"}]];Nt(we,dt({name:"square-mouse-pointer"},()=>Ue,{get iconNode(){return Se},children:(pe,$)=>{var se=O(),Y=n(se);Qt(Y,()=>M.children??Ht),t(pe,se)},$$slots:{default:!0}})),Pt()}function $s(we){return new Date(we).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}var hs=c("<!> <!> <!>",1),ys=c('<div><p class="text-sm font-medium text-muted-foreground">Total Compose Projects</p> <p class="text-2xl font-bold"> </p></div> <div class="bg-primary/10 p-2 rounded-full"><!></div>',1),xs=c('<div><p class="text-sm font-medium text-muted-foreground">Running</p> <p class="text-2xl font-bold"> </p></div> <div class="bg-green-500/10 p-2 rounded-full"><!></div>',1),ks=c('<div><p class="text-sm font-medium text-muted-foreground">Partially Running</p> <p class="text-2xl font-bold"> </p></div> <div class="bg-amber-500/10 p-2 rounded-full"><!></div>',1),ws=c('<p class="text-sm text-muted-foreground">Loading remote compose projects...</p>'),Ss=c("<!> Refresh Remote",1),bs=c('<div class="flex items-center justify-between"><div><!> <!></div> <div class="flex items-center gap-2"><!> <!></div></div>'),Ps=c('<div class="flex items-center gap-2"> </div>'),Cs=c('<a class="font-medium hover:underline"> </a> <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full"> </span>',1),zs=c('<a class="font-medium hover:underline"> </a>'),Rs=c('<span title="This stack uses the legacy layout. Migrate to the new layout from the dropdown menu." class="ml-1 flex items-center" style="filter: drop-shadow(0 0 4px #fbbf24);"><!></span>'),js=c('<div class="flex items-center gap-2"><!> <!></div>'),As=c('<span class="sr-only">Open menu</span> <!>',1),Ls=c("<!> Edit",1),Fs=c("<!> Start",1),Ts=c("<!> Restart",1),Es=c("<!> Stop",1),Is=c("<!> <!>",1),Ds=c("<!> Pull & Redeploy",1),Os=c("<!> Remove",1),Ms=c("<!> View Agent",1),Us=c("<!> <!> <!> <!> <!> <!> <!>",1),Ks=c("<!> <!>",1),Vs=c('<span class="sr-only">Open menu</span> <!>',1),Js=c("<!> Edit",1),qs=c("<!> Start",1),Bs=c("<!> Restart",1),Gs=c("<!> Stop",1),Hs=c("<!> <!>",1),Ws=c('<span title="This stack uses the legacy layout. Migrate to the new layout." class="mr-2 flex items-center"><!></span> Migrate',1),Ns=c("<!> Destroy",1),Qs=c("<!> <!> <!> <!> <!>",1),Xs=c("<!> <!>",1),Ys=c("<!> <!> <!> <!> <!> <!>",1),Zs=c('<div class="flex flex-col items-center justify-center py-12 px-6 text-center"><!> <p class="text-lg font-medium">No stacks found</p> <p class="text-sm text-muted-foreground mt-1 max-w-md">Create a new stack using the "Create Stack" button above or import an existing compose file</p> <div class="flex gap-3 mt-4"><!></div></div>'),ea=c("<!> <!>",1),ta=c('<div class="space-y-6"><div class="flex flex-col sm:flex-row justify-between sm:items-center gap-4"><div><h1 class="text-3xl font-bold tracking-tight">Compose Projects</h1> <p class="text-sm text-muted-foreground mt-1">View and Manage Compose Projects</p></div></div> <!> <div class="grid grid-cols-1 sm:grid-cols-3 gap-4"><!> <!> <!></div> <!></div>');function Ta(we,M){bt(M,!0);let Ue=S(()=>M.data.stacks),Se=S(()=>M.data.agents||[]),pe=At(!1);const $=ls({start:!1,stop:!1,restart:!1,remove:!1,import:!1,redeploy:!1,destroy:!1,pull:!1,migrate:!1}),se=S(()=>Object.values($).some(o=>o)),Y=new _s,Le=S(()=>r(Ue)),Xt=S(()=>{var o;return((o=r(Le))==null?void 0:o.length)||0}),Yt=S(()=>{var o;return((o=r(Le))==null?void 0:o.filter(a=>a.status==="running").length)||0}),Zt=S(()=>{var o;return((o=r(Le))==null?void 0:o.filter(a=>a.status==="partially running").length)||0});let U=At(null);async function Ke(o,a){$[o]=!0,o==="start"?Ae({result:await ke(Y.deploy(a)),message:"Failed to Start Stack",setLoadingState:s=>$.start=s,onSuccess:async()=>{R.success("Stack Started Successfully."),await ie()}}):o==="stop"?Ae({result:await ke(Y.down(a)),message:"Failed to Stop Stack",setLoadingState:s=>$.stop=s,onSuccess:async()=>{R.success("Stack Stopped Successfully."),await ie()}}):o==="restart"?Ae({result:await ke(Y.restart(a)),message:"Failed to Restart Stack",setLoadingState:s=>$.restart=s,onSuccess:async()=>{R.success("Stack Restarted Successfully."),await ie()}}):o==="redeploy"?Ae({result:await ke(Y.redeploy(a)),message:"Failed to Redeploy Stack",setLoadingState:s=>$.redeploy=s,onSuccess:async()=>{R.success("Stack redeployed successfully."),await ie()}}):o==="pull"?Ae({result:await ke(Y.pull(a)),message:"Failed to pull Stack",setLoadingState:s=>$.pull=s,onSuccess:async()=>{R.success("Stack Pulled successfully."),await ie()}}):o==="destroy"?Tt({title:"Confirm Removal",message:"Are you sure you want to remove this Stack? This action cannot be undone.",confirm:{label:"Remove",destructive:!0,action:async()=>{Ae({result:await ke(Y.destroy(a)),message:"Failed to Remove Stack",setLoadingState:s=>$.destroy=s,onSuccess:async()=>{R.success("Stack Removed Successfully"),await ie()}})}}}):o==="migrate"?Ae({result:await ke(Y.migrate(a)),message:"Failed to Migrate Stack",setLoadingState:s=>$.migrate=s,onSuccess:async()=>{R.success("Stack Migrated Successfully."),await ie()}}):(console.error("An Unknown Error Occurred"),R.error("An Unknown Error Occurred"))}async function es(o,a){$.import=!0;const s=await ke(Y.import(o,a));if(s.error){console.error(`Failed to import Stack ${o}:`,s.error),R.error(`Failed to import Stack: ${s.error.message}`),$.import=!1;return}R.success("Stack Imported successfully."),await ie(),$.import=!1}async function ts(o,a){Tt({title:"Confirm Stack Removal",message:`Are you sure you want to remove the stack "${a}" from agent "${o}"? This action cannot be undone.`,confirm:{label:"Remove",destructive:!0,action:async()=>{Oe(U,`${o}:${a}:remove`);try{const s=await fetch(`/api/agents/${o}/tasks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"stack_destroy",payload:{project_name:a}})});if(!s.ok){const ce=await s.json();throw new Error(ce.error||"Failed to remove stack")}R.success(`Stack ${a} destroyed successfully`),await ie()}catch(s){console.error("Failed to remove remote stack:",s),R.error(`Failed to remove stack: ${s instanceof Error?s.message:"Unknown error"}`)}finally{Oe(U,null)}}}})}async function ss(){if(r(Se).length!==0){Oe(pe,!0);try{const o=r(Se).map(async a=>{try{const s=await fetch(`/api/agents/${a.id}/stacks`);if(!s.ok)throw new Error(`Failed to fetch stacks from ${a.hostname}`);return((await s.json()).stacks||[]).map(p=>{var F;return{...p,agentId:a.id,agentHostname:a.hostname,isRemote:!0,id:`${a.id}:${p.Name||p.id}`,name:p.Name||p.name,status:((F=p.Status)==null?void 0:F.toLowerCase())||"unknown",serviceCount:p.ServiceCount||0,source:"Remote",createdAt:p.CreatedAt||new Date().toISOString()}})}catch(s){return console.error(`Failed to load stacks from agent ${a.hostname}:`,s),[]}});await ie(),R.success("Remote stacks refreshed")}catch(o){console.error("Failed to load agent stacks:",o),R.error("Failed to load some remote stacks")}finally{Oe(pe,!1)}}}async function Ze(o,a,s){var p,F;const ce=`${o}:${a}:${s}`;Oe(U,ce);try{let b,P;switch(s){case"up":b="compose_up",P={project_name:a};break;case"down":b="compose_down",P={project_name:a};break;case"restart":b="compose_restart",P={project_name:a};break;case"remove":b="compose_remove",P={project_name:a};break;case"pull":b="compose_pull",P={project_name:a};break}const T=await fetch(`/api/agents/${o}/tasks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:b,payload:P})});if(!T.ok){const _=await T.json();throw new Error(_.error||`Failed to ${s} stack`)}const K=(p=(await T.json()).task)==null?void 0:p.id;if(!K)throw new Error("No task ID returned from agent");const f=async _=>{var k,fe;for(let _e=0;_e<30;_e++){await new Promise(E=>setTimeout(E,1e3));try{const E=await fetch(`/api/agents/${o}/tasks/${_}`);if(!E.ok)continue;const Z=await E.json(),e=(k=Z.task)==null?void 0:k.status;if(e==="completed")return!0;if(e==="failed")throw new Error(((fe=Z.task)==null?void 0:fe.error)||"Task failed")}catch(E){console.warn(`Polling attempt ${_e+1} failed:`,E)}}throw new Error("Task polling timed out")};if(await f(K),s==="pull"){R.success(`Images pulled for ${a}`);const _=await fetch(`/api/agents/${o}/tasks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"compose_up",payload:{project_name:a}})});if(_.ok){const j=await _.json();(F=j.task)!=null&&F.id&&await f(j.task.id)}R.success(`Stack ${a} redeployed with new images`)}else s==="remove"?R.success(`Compose Project ${a} destroyed successfully`):R.success(`Compose Project ${a} ${s==="up"?"started":s==="down"?"stopped":"restarted"} successfully`);await ie()}catch(b){console.error(`Failed to ${s} remote Compose Project:`,b),R.error(`Failed to ${s} stack: ${b instanceof Error?b.message:"Unknown error"}`)}finally{Oe(U,null)}}var ut=ta(),Ct=i(h(ut),2);{var as=o=>{var a=O(),s=n(a);l(s,()=>us,(ce,p)=>{p(ce,{variant:"destructive",children:(F,b)=>{var P=hs(),T=n(P);wt(T,{class:"size-4"});var de=i(T,2);l(de,()=>ms,(f,_)=>{_(f,{children:(j,V)=>{z();var k=Xe("Error Loading Compose Projects");t(j,k)},$$slots:{default:!0}})});var K=i(de,2);l(K,()=>vs,(f,_)=>{_(f,{children:(j,V)=>{z();var k=Xe();he(()=>me(k,M.data.error)),t(j,k)},$$slots:{default:!0}})}),t(F,P)},$$slots:{default:!0}})}),t(o,a)};x(Ct,o=>{M.data.error&&o(as)})}var mt=i(Ct,2),zt=h(mt);l(zt,()=>it,(o,a)=>{a(o,{children:(s,ce)=>{var p=O(),F=n(p);l(F,()=>ct,(b,P)=>{P(b,{class:"p-4 flex items-center justify-between",children:(T,de)=>{var K=ys(),f=n(K),_=i(h(f),2),j=h(_,!0);y(_),y(f);var V=i(f,2),k=h(V);Kt(k,{class:"text-primary size-5"}),y(V),he(()=>me(j,r(Xt))),t(T,K)},$$slots:{default:!0}})}),t(s,p)},$$slots:{default:!0}})});var Rt=i(zt,2);l(Rt,()=>it,(o,a)=>{a(o,{children:(s,ce)=>{var p=O(),F=n(p);l(F,()=>ct,(b,P)=>{P(b,{class:"p-4 flex items-center justify-between",children:(T,de)=>{var K=xs(),f=n(K),_=i(h(f),2),j=h(_,!0);y(_),y(f);var V=i(f,2),k=h(V);Vt(k,{class:"text-green-500 size-5"}),y(V),he(()=>me(j,r(Yt))),t(T,K)},$$slots:{default:!0}})}),t(s,p)},$$slots:{default:!0}})});var rs=i(Rt,2);l(rs,()=>it,(o,a)=>{a(o,{children:(s,ce)=>{var p=O(),F=n(p);l(F,()=>ct,(b,P)=>{P(b,{class:"p-4 flex items-center justify-between",children:(T,de)=>{var K=ks(),f=n(K),_=i(h(f),2),j=h(_,!0);y(_),y(f);var V=i(f,2),k=h(V);Vt(k,{class:"text-amber-500 size-5"}),y(V),he(()=>me(j,r(Zt))),t(T,K)},$$slots:{default:!0}})}),t(s,p)},$$slots:{default:!0}})}),y(mt);var os=i(mt,2);l(os,()=>it,(o,a)=>{a(o,{class:"border shadow-sm",children:(s,ce)=>{var p=ea(),F=n(p);l(F,()=>is,(P,T)=>{T(P,{class:"px-6",children:(de,K)=>{var f=bs(),_=h(f),j=h(_);l(j,()=>cs,(e,ae)=>{ae(e,{children:(Fe,Te)=>{z();var Ee=Xe("Compose Projects List");t(Fe,Ee)},$$slots:{default:!0}})});var V=i(j,2);{var k=e=>{var ae=ws();t(e,ae)};x(V,e=>{r(pe)&&e(k)})}y(_);var fe=i(_,2),_e=h(fe);{var E=e=>{yt(e,{variant:"outline",size:"sm",onclick:ss,get disabled(){return r(pe)},children:(ae,Fe)=>{var Te=Ss(),Ee=n(Te);{var et=Ie=>{ve(Ie,{class:"size-4 animate-spin mr-2"})};x(Ee,Ie=>{r(pe)&&Ie(et)})}z(),t(ae,Te)},$$slots:{default:!0}})};x(_e,e=>{r(Se).length>0&&e(E)})}var Z=i(_e,2);xt(Z,{action:"create",customLabel:"Create Compose Project",onClick:()=>Ye("/compose/new")}),y(fe),y(f),t(de,f)},$$slots:{default:!0}})});var b=i(F,2);l(b,()=>ct,(P,T)=>{T(P,{children:(de,K)=>{var f=O(),_=n(f);{var j=k=>{const fe=S(()=>({pageSize:Ut.getPageSize("stacks")}));ds(k,{get data(){return r(Le)},columns:[{accessorKey:"name",header:"Name"},{accessorKey:"serviceCount",header:"Services"},{accessorKey:"status",header:"Status"},{accessorKey:"source",header:"Source"},{accessorKey:"createdAt",header:"Created"},{accessorKey:"actions",header:" ",enableSorting:!1}],features:{selection:!1},get pagination(){return r(fe)},onPageSizeChange:E=>{Ut.setPageSize("stacks",E)},sort:{defaultSort:{id:"name",desc:!1}},display:{filterPlaceholder:"Search compose projects...",noResultsMessage:"No stacks found"},rows:(E,Z)=>{let e=()=>Z==null?void 0:Z().item;var ae=Ys();const Fe=S(()=>e().status?fs[e().status.toLowerCase()]:"gray");var Te=n(ae);l(Te,()=>Me,(re,oe)=>{oe(re,{children:(ne,Ve)=>{var J=O(),be=n(J);{var vt=W=>{var ge=Ps(),De=h(ge,!0);y(ge),he(()=>me(De,e().name)),t(W,ge)},pt=W=>{var ge=js(),De=h(ge);{var ft=G=>{var q=Cs(),ee=n(q),_t=h(ee,!0);y(ee);var xe=i(ee,2),Ce=h(xe);y(xe),he(()=>{Lt(ee,"href",`/compose/agent/${e().agentId??""}/${e().name??""}`),me(_t,e().name),me(Ce,`On ${e().agentId??""}`)}),t(G,q)},ye=G=>{var q=zs(),ee=h(q,!0);y(q),he(()=>{Lt(q,"href",`/compose/${e().id??""}/`),me(ee,e().name)}),t(G,q)};x(De,G=>{e().isRemote?G(ft):G(ye,!1)})}var Pe=i(De,2);{var Je=G=>{var q=Rs(),ee=h(q);wt(ee,{class:"text-amber-400 animate-pulse size-4"}),y(q),t(G,q)};x(Pe,G=>{e().isLegacy&&G(Je)})}y(ge),t(W,ge)};x(be,W=>{e().isExternal?W(vt):W(pt,!1)})}t(ne,J)},$$slots:{default:!0}})});var Ee=i(Te,2);l(Ee,()=>Me,(re,oe)=>{oe(re,{children:(ne,Ve)=>{z();var J=Xe();he(()=>me(J,e().serviceCount)),t(ne,J)},$$slots:{default:!0}})});var et=i(Ee,2);l(et,()=>Me,(re,oe)=>{oe(re,{children:(ne,Ve)=>{const J=S(()=>ps(e().status));Mt(ne,{get variant(){return r(Fe)},get text(){return r(J)}})},$$slots:{default:!0}})});var Ie=i(et,2);l(Ie,()=>Me,(re,oe)=>{oe(re,{children:(ne,Ve)=>{const J=S(()=>e().isExternal?"amber":e().isRemote?"blue":"green"),be=S(()=>e().isExternal?"External":e().isRemote?"Remote":"Managed");Mt(ne,{get variant(){return r(J)},get text(){return r(be)}})},$$slots:{default:!0}})});var jt=i(Ie,2);l(jt,()=>Me,(re,oe)=>{oe(re,{children:(ne,Ve)=>{z();var J=Xe();he(be=>me(J,be),[()=>$s(e().createdAt||"")]),t(ne,J)},$$slots:{default:!0}})});var ns=i(jt,2);l(ns,()=>Me,(re,oe)=>{oe(re,{children:(ne,Ve)=>{var J=O(),be=n(J);{var vt=W=>{xt(W,{action:"pull",customLabel:"Import",onClick:()=>es(e().id,e().name),get loading(){return $.import},get disabled(){return $.import}})},pt=(W,ge)=>{{var De=ye=>{var Pe=O(),Je=n(Pe);l(Je,()=>Et,(G,q)=>{q(G,{children:(ee,_t)=>{var xe=Ks(),Ce=n(xe);l(Ce,()=>It,(ze,Re)=>{Re(ze,{child:(Be,N)=>{yt(Be,dt(()=>N==null?void 0:N().props,{variant:"ghost",size:"icon",class:"relative size-8 p-0",children:(je,He)=>{var $e=As(),We=i(n($e),2);Ft(We,{}),t(je,$e)},$$slots:{default:!0}}))},$$slots:{child:!0}})});var gt=i(Ce,2);l(gt,()=>Dt,(ze,Re)=>{Re(ze,{align:"end",children:(qe,Be)=>{var N=O(),Ge=n(N);l(Ge,()=>Ot,(je,He)=>{He(je,{children:($e,We)=>{var Ne=Us(),Qe=n(Ne);const tt=S(()=>!!r(U));l(Qe,()=>X,(m,d)=>{d(m,{onclick:()=>Ye(`/compose/agent/${e().agentId}/${e().name}`),get disabled(){return r(tt)},children:(w,I)=>{var g=Ls(),u=n(g);Gt(u,{class:"size-4"}),z(),t(w,g)},$$slots:{default:!0}})});var st=i(Qe,2);{var $t=m=>{var d=O(),w=n(d);const I=S(()=>!!r(U));l(w,()=>X,(g,u)=>{u(g,{onclick:()=>Ze(e().agentId||"",e().name,"up"),get disabled(){return r(I)},children:(B,D)=>{var v=Fs(),H=n(v);{var le=ue=>{ve(ue,{class:"animate-spin size-4"})},C=ue=>{qt(ue,{class:"size-4"})};x(H,ue=>{r(U)===`${e().agentId}:${e().name}:up`?ue(le):ue(C,!1)})}z(),t(B,v)},$$slots:{default:!0}})}),t(m,d)},at=m=>{var d=Is(),w=n(d);const I=S(()=>!!r(U));l(w,()=>X,(B,D)=>{D(B,{onclick:()=>Ze(e().agentId||"",e().name,"restart"),get disabled(){return r(I)},children:(v,H)=>{var le=Ts(),C=n(le);{var ue=Q=>{ve(Q,{class:"animate-spin size-4"})},ht=Q=>{kt(Q,{class:"size-4"})};x(C,Q=>{r(U)===`${e().agentId}:${e().name}:restart`?Q(ue):Q(ht,!1)})}z(),t(v,le)},$$slots:{default:!0}})});var g=i(w,2);const u=S(()=>!!r(U));l(g,()=>X,(B,D)=>{D(B,{onclick:()=>Ze(e().agentId||"",e().name,"down"),get disabled(){return r(u)},children:(v,H)=>{var le=Es(),C=n(le);{var ue=Q=>{ve(Q,{class:"animate-spin size-4"})},ht=Q=>{Bt(Q,{class:"size-4"})};x(C,Q=>{r(U)===`${e().agentId}:${e().name}:down`?Q(ue):Q(ht,!1)})}z(),t(v,le)},$$slots:{default:!0}})}),t(m,d)};x(st,m=>{e().status!=="running"?m($t):m(at,!1)})}var rt=i(st,2);const ot=S(()=>!!r(U));l(rt,()=>X,(m,d)=>{d(m,{onclick:()=>Ze(e().agentId||"",e().name,"pull"),get disabled(){return r(ot)},children:(w,I)=>{var g=Ds(),u=n(g);{var B=v=>{ve(v,{class:"animate-spin size-4"})},D=v=>{kt(v,{class:"size-4"})};x(u,v=>{r(U)===`${e().agentId}:${e().name}:pull`?v(B):v(D,!1)})}z(),t(w,g)},$$slots:{default:!0}})});var nt=i(rt,2);l(nt,()=>St,(m,d)=>{d(m,{})});var lt=i(nt,2);const A=S(()=>!!r(U));l(lt,()=>X,(m,d)=>{d(m,{class:"text-red-500 focus:text-red-700!",onclick:()=>ts(e().agentId||"",e().name),get disabled(){return r(A)},children:(w,I)=>{var g=Os(),u=n(g);{var B=v=>{ve(v,{class:"animate-spin size-4"})},D=v=>{Jt(v,{class:"size-4"})};x(u,v=>{r(U)?v(B):v(D,!1)})}z(),t(w,g)},$$slots:{default:!0}})});var L=i(lt,2);l(L,()=>St,(m,d)=>{d(m,{})});var te=i(L,2);l(te,()=>X,(m,d)=>{d(m,{onclick:()=>Ye(`/agents/${e().agentId}`),children:(w,I)=>{var g=Ms(),u=n(g);gs(u,{class:"size-4"}),z(),t(w,g)},$$slots:{default:!0}})}),t($e,Ne)},$$slots:{default:!0}})}),t(qe,N)},$$slots:{default:!0}})}),t(ee,xe)},$$slots:{default:!0}})}),t(ye,Pe)},ft=ye=>{var Pe=O(),Je=n(Pe);l(Je,()=>Et,(G,q)=>{q(G,{children:(ee,_t)=>{var xe=Xs(),Ce=n(xe);l(Ce,()=>It,(ze,Re)=>{Re(ze,{child:(Be,N)=>{yt(Be,dt(()=>N==null?void 0:N().props,{variant:"ghost",size:"icon",class:"relative size-8 p-0",children:(je,He)=>{var $e=Vs(),We=i(n($e),2);Ft(We,{}),t(je,$e)},$$slots:{default:!0}}))},$$slots:{child:!0}})});var gt=i(Ce,2);l(gt,()=>Dt,(ze,Re)=>{Re(ze,{align:"end",children:(qe,Be)=>{var N=O(),Ge=n(N);l(Ge,()=>Ot,(je,He)=>{He(je,{children:($e,We)=>{var Ne=Qs(),Qe=n(Ne);l(Qe,()=>X,(A,L)=>{L(A,{onclick:()=>Ye(`/compose/${e().id}`),get disabled(){return r(se)},children:(te,m)=>{var d=Js(),w=n(d);Gt(w,{class:"size-4"}),z(),t(te,d)},$$slots:{default:!0}})});var tt=i(Qe,2);{var st=A=>{var L=O(),te=n(L);const m=S(()=>$.start||r(se));l(te,()=>X,(d,w)=>{w(d,{onclick:()=>Ke("start",e().id),get disabled(){return r(m)},children:(I,g)=>{var u=qs(),B=n(u);{var D=H=>{ve(H,{class:"animate-spin size-4"})},v=H=>{qt(H,{class:"size-4"})};x(B,H=>{$.start?H(D):H(v,!1)})}z(),t(I,u)},$$slots:{default:!0}})}),t(A,L)},$t=A=>{var L=Hs(),te=n(L);const m=S(()=>$.restart||r(se));l(te,()=>X,(I,g)=>{g(I,{onclick:()=>Ke("restart",e().id),get disabled(){return r(m)},children:(u,B)=>{var D=Bs(),v=n(D);{var H=C=>{ve(C,{class:"animate-spin size-4"})},le=C=>{kt(C,{class:"size-4"})};x(v,C=>{$.restart?C(H):C(le,!1)})}z(),t(u,D)},$$slots:{default:!0}})});var d=i(te,2);const w=S(()=>$.stop||r(se));l(d,()=>X,(I,g)=>{g(I,{onclick:()=>Ke("stop",e().id),get disabled(){return r(w)},children:(u,B)=>{var D=Gs(),v=n(D);{var H=C=>{ve(C,{class:"animate-spin size-4"})},le=C=>{Bt(C,{class:"size-4"})};x(v,C=>{$.stop?C(H):C(le,!1)})}z(),t(u,D)},$$slots:{default:!0}})}),t(A,L)};x(tt,A=>{e().status!=="running"?A(st):A($t,!1)})}var at=i(tt,2);{var rt=A=>{var L=O(),te=n(L);l(te,()=>X,(m,d)=>{d(m,{onclick:()=>Ke("migrate",e().id),class:"text-amber-600 hover:text-amber-800 flex items-center",children:(w,I)=>{var g=Ws(),u=n(g),B=h(u);wt(B,{class:"text-amber-500 size-4"}),y(u),z(),t(w,g)},$$slots:{default:!0}})}),t(A,L)};x(at,A=>{e().isLegacy&&A(rt)})}var ot=i(at,2);l(ot,()=>St,(A,L)=>{L(A,{})});var nt=i(ot,2);const lt=S(()=>$.remove||r(se));l(nt,()=>X,(A,L)=>{L(A,{class:"text-red-500 focus:text-red-700!",onclick:()=>Ke("destroy",e().id),get disabled(){return r(lt)},children:(te,m)=>{var d=Ns(),w=n(d);{var I=u=>{ve(u,{class:"animate-spin size-4"})},g=u=>{Jt(u,{class:"size-4"})};x(w,u=>{$.remove?u(I):u(g,!1)})}z(),t(te,d)},$$slots:{default:!0}})}),t($e,Ne)},$$slots:{default:!0}})}),t(qe,N)},$$slots:{default:!0}})}),t(ee,xe)},$$slots:{default:!0}})}),t(ye,Pe)};x(W,ye=>{e().isRemote?ye(De):ye(ft,!1)},ge)}};x(be,W=>{e().isExternal?W(vt):W(pt,!1)})}t(ne,J)},$$slots:{default:!0}})}),t(E,ae)},$$slots:{rows:!0}})},V=(k,fe)=>{{var _e=E=>{var Z=Zs(),e=h(Z);Kt(e,{class:"text-muted-foreground mb-4 opacity-40 size-12"});var ae=i(e,6),Fe=h(ae);xt(Fe,{action:"create",customLabel:"Create Stack",onClick:()=>Ye("/compose/new"),size:"sm"}),y(ae),y(Z),t(E,Z)};x(k,E=>{M.data.error||E(_e)},fe)}};x(_,k=>{r(Le)&&r(Le).length>0?k(j):k(V,!1)})}t(de,f)},$$slots:{default:!0}})}),t(s,p)},$$slots:{default:!0}})}),y(ut),t(we,ut),Pt()}export{Ta as component};
