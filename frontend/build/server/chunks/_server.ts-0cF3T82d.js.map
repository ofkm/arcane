{"version":3,"file":"_server.ts-0cF3T82d.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/images/_id_/maturity/_server.ts.js"],"sourcesContent":["import { j as json } from \"../../../../../../chunks/index.js\";\nimport { c as checkImageMaturityBatch, b as checkImageMaturity, i as imageMaturityDb } from \"../../../../../../chunks/image-service.js\";\nimport { A as ApiErrorCode } from \"../../../../../../chunks/errors.type.js\";\nimport { e as extractDockerErrorMessage } from \"../../../../../../chunks/errors.util.js\";\nconst POST = async ({ request }) => {\n  const body = await request.json().catch(() => ({}));\n  const { imageIds } = body;\n  if (!imageIds || !Array.isArray(imageIds) || imageIds.length === 0) {\n    const response = {\n      success: false,\n      error: \"Image IDs array is required\",\n      code: ApiErrorCode.BAD_REQUEST\n    };\n    return json(response, { status: 400 });\n  }\n  try {\n    console.log(`Server: Starting batch maturity check for ${imageIds.length} images`);\n    const results = await checkImageMaturityBatch(imageIds);\n    const errors = {};\n    const successResults = {};\n    let successCount = 0;\n    let failCount = 0;\n    for (const [imageId, maturity] of results) {\n      if (maturity) {\n        successResults[imageId] = maturity;\n        successCount++;\n      } else {\n        errors[imageId] = \"No maturity data available\";\n        failCount++;\n      }\n    }\n    console.log(`Server: Batch maturity check completed. ${successCount} successful, ${failCount} failed`);\n    return json({\n      success: true,\n      results: successResults,\n      errors,\n      stats: {\n        total: imageIds.length,\n        success: successCount,\n        failed: failCount\n      }\n    });\n  } catch (error) {\n    console.error(\"Server: Error in batch maturity check:\", error);\n    const response = {\n      success: false,\n      error: error instanceof Error ? error.message : \"Unknown error occurred\",\n      code: ApiErrorCode.INTERNAL_SERVER_ERROR,\n      details: error\n    };\n    return json(response, { status: 500 });\n  }\n};\nconst GET = async ({ params }) => {\n  const { id } = params;\n  if (!id) {\n    const response = {\n      success: false,\n      error: \"Image ID is required\",\n      code: ApiErrorCode.BAD_REQUEST\n    };\n    return json(response, { status: 400 });\n  }\n  try {\n    const result = await checkImageMaturity(id);\n    if (!result) {\n      const response = {\n        success: false,\n        error: \"No maturity data available for this image\",\n        code: ApiErrorCode.NOT_FOUND\n      };\n      return json(response, { status: 404 });\n    }\n    return json({\n      success: true,\n      result\n    });\n  } catch (error) {\n    console.error(\"Error checking image maturity:\", error);\n    const response = {\n      success: false,\n      error: extractDockerErrorMessage(error),\n      code: ApiErrorCode.DOCKER_API_ERROR,\n      details: error\n    };\n    return json(response, { status: 500 });\n  }\n};\nconst OPTIONS = async () => {\n  try {\n    const stats = await imageMaturityDb.getMaturityStats();\n    return json({\n      success: true,\n      stats\n    });\n  } catch (error) {\n    console.error(\"Error getting maturity stats:\", error);\n    return json(\n      {\n        success: false,\n        error: \"Failed to get maturity statistics\"\n      },\n      { status: 500 }\n    );\n  }\n};\nexport {\n  GET,\n  OPTIONS,\n  POST\n};\n"],"names":[],"mappings":"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"}