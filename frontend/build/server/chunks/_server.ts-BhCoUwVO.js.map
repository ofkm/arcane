{"version":3,"file":"_server.ts-BhCoUwVO.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/images/prune/_server.ts.js"],"sourcesContent":["import { j as json } from \"../../../../../chunks/index.js\";\nimport { a as pruneImages } from \"../../../../../chunks/image-service.js\";\nimport { g as getSettings } from \"../../../../../chunks/settings-service.js\";\nimport { f as formatBytes } from \"../../../../../chunks/bytes.util.js\";\nimport { A as ApiErrorCode } from \"../../../../../chunks/errors.type.js\";\nimport { e as extractDockerErrorMessage } from \"../../../../../chunks/errors.util.js\";\nimport { t as tryCatch } from \"../../../../../chunks/try-catch.js\";\nconst POST = async () => {\n  const settingsResult = await tryCatch(getSettings());\n  if (settingsResult.error) {\n    console.error(\"Error getting settings:\", settingsResult.error);\n    const response = {\n      success: false,\n      error: \"Failed to retrieve settings\",\n      code: ApiErrorCode.INTERNAL_SERVER_ERROR,\n      details: settingsResult.error\n    };\n    return json(response, { status: 500 });\n  }\n  const pruneMode = settingsResult.data.pruneMode;\n  const pruneResult = await tryCatch(pruneImages(pruneMode));\n  if (pruneResult.error) {\n    console.error(\"Error pruning images:\", pruneResult.error);\n    const response = {\n      success: false,\n      error: extractDockerErrorMessage(pruneResult.error),\n      code: ApiErrorCode.DOCKER_API_ERROR,\n      details: pruneResult.error\n    };\n    return json(response, { status: 500 });\n  }\n  const result = pruneResult.data;\n  const spaceReclaimedFormatted = formatBytes(result.SpaceReclaimed || 0);\n  const message = result.ImagesDeleted && result.ImagesDeleted.length > 0 ? `Successfully pruned ${result.ImagesDeleted.length} image(s). Space reclaimed: ${spaceReclaimedFormatted}.` : `No unused images found to prune. Space reclaimed: ${spaceReclaimedFormatted}.`;\n  return json({\n    success: true,\n    message,\n    spaceReclaimed: result.SpaceReclaimed,\n    imagesDeletedCount: result.ImagesDeleted?.length || 0\n  });\n};\nexport {\n  POST\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAOK,MAAC,IAAI,GAAG,YAAY;AACzB,EAAE,MAAM,cAAc,GAAG,MAAM,QAAQ,CAAC,WAAW,EAAE,CAAC;AACtD,EAAE,IAAI,cAAc,CAAC,KAAK,EAAE;AAC5B,IAAI,OAAO,CAAC,KAAK,CAAC,yBAAyB,EAAE,cAAc,CAAC,KAAK,CAAC;AAClE,IAAI,MAAM,QAAQ,GAAG;AACrB,MAAM,OAAO,EAAE,KAAK;AACpB,MAAM,KAAK,EAAE,6BAA6B;AAC1C,MAAM,IAAI,EAAE,YAAY,CAAC,qBAAqB;AAC9C,MAAM,OAAO,EAAE,cAAc,CAAC;AAC9B,KAAK;AACL,IAAI,OAAO,IAAI,CAAC,QAAQ,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC;AAC1C;AACA,EAAE,MAAM,SAAS,GAAG,cAAc,CAAC,IAAI,CAAC,SAAS;AACjD,EAAE,MAAM,WAAW,GAAG,MAAM,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;AAC5D,EAAE,IAAI,WAAW,CAAC,KAAK,EAAE;AACzB,IAAI,OAAO,CAAC,KAAK,CAAC,uBAAuB,EAAE,WAAW,CAAC,KAAK,CAAC;AAC7D,IAAI,MAAM,QAAQ,GAAG;AACrB,MAAM,OAAO,EAAE,KAAK;AACpB,MAAM,KAAK,EAAE,yBAAyB,CAAC,WAAW,CAAC,KAAK,CAAC;AACzD,MAAM,IAAI,EAAE,YAAY,CAAC,gBAAgB;AACzC,MAAM,OAAO,EAAE,WAAW,CAAC;AAC3B,KAAK;AACL,IAAI,OAAO,IAAI,CAAC,QAAQ,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC;AAC1C;AACA,EAAE,MAAM,MAAM,GAAG,WAAW,CAAC,IAAI;AACjC,EAAE,MAAM,uBAAuB,GAAG,WAAW,CAAC,MAAM,CAAC,cAAc,IAAI,CAAC,CAAC;AACzE,EAAE,MAAM,OAAO,GAAG,MAAM,CAAC,aAAa,IAAI,MAAM,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,oBAAoB,EAAE,MAAM,CAAC,aAAa,CAAC,MAAM,CAAC,4BAA4B,EAAE,uBAAuB,CAAC,CAAC,CAAC,GAAG,CAAC,kDAAkD,EAAE,uBAAuB,CAAC,CAAC,CAAC;AACzQ,EAAE,OAAO,IAAI,CAAC;AACd,IAAI,OAAO,EAAE,IAAI;AACjB,IAAI,OAAO;AACX,IAAI,cAAc,EAAE,MAAM,CAAC,cAAc;AACzC,IAAI,kBAAkB,EAAE,MAAM,CAAC,aAAa,EAAE,MAAM,IAAI;AACxD,GAAG,CAAC;AACJ;;;;"}