{"version":3,"file":"template-registry-service-CoCZP6pF.js","sources":["../../../.svelte-kit/adapter-node/chunks/template-registry-service.js"],"sourcesContent":["import { b as browser } from \"./index5.js\";\nclass TemplateRegistryService {\n  cache = /* @__PURE__ */ new Map();\n  defaultCacheTtl = 3600;\n  // 1 hour\n  async fetchRegistry(config) {\n    try {\n      const cached = this.cache.get(config.url);\n      const now = Date.now();\n      const ttl = (config.cache_ttl || this.defaultCacheTtl) * 1e3;\n      if (cached && now - cached.timestamp < ttl) {\n        return cached.data;\n      }\n      let registry;\n      if (browser) ;\n      else {\n        const response = await fetch(config.url, {\n          headers: {\n            \"User-Agent\": \"Arcane-Template-Registry/1.0\",\n            Accept: \"application/json\"\n          }\n        });\n        if (!response.ok) {\n          throw new Error(`Failed to fetch registry: ${response.statusText}`);\n        }\n        registry = await response.json();\n      }\n      this.validateRegistry(registry);\n      this.cache.set(config.url, { data: registry, timestamp: now });\n      return registry;\n    } catch (error) {\n      console.error(`Error fetching template registry from ${config.url}:`, error);\n      return null;\n    }\n  }\n  async fetchTemplateContent(template) {\n    try {\n      if (browser) ;\n      else {\n        const response = await fetch(template.compose_url, {\n          headers: {\n            \"User-Agent\": \"Arcane-Template-Registry/1.0\",\n            Accept: \"text/plain, application/x-yaml, text/yaml, */*\"\n          }\n        });\n        if (!response.ok) {\n          throw new Error(`Failed to fetch template content: ${response.statusText}`);\n        }\n        return await response.text();\n      }\n    } catch (error) {\n      console.error(`Error fetching template content from ${template.compose_url}:`, error);\n      return null;\n    }\n  }\n  async fetchEnvContent(envUrl) {\n    try {\n      if (browser) ;\n      else {\n        const response = await fetch(envUrl, {\n          headers: {\n            \"User-Agent\": \"Arcane-Template-Registry/1.0\",\n            Accept: \"text/plain, */*\"\n          }\n        });\n        if (!response.ok) {\n          throw new Error(`Failed to fetch environment content: ${response.statusText}`);\n        }\n        return await response.text();\n      }\n    } catch (error) {\n      console.error(`Error fetching environment content from ${envUrl}:`, error);\n      return null;\n    }\n  }\n  convertToComposeTemplate(remote, registryName) {\n    return {\n      id: `${registryName}:${remote.id}`,\n      name: remote.name,\n      description: remote.description,\n      content: \"\",\n      // Will be loaded on demand\n      isCustom: true,\n      isRemote: true,\n      metadata: {\n        version: remote.version,\n        author: remote.author,\n        tags: remote.tags,\n        registry: registryName,\n        remoteUrl: remote.compose_url,\n        envUrl: remote.env_url,\n        documentationUrl: remote.documentation_url,\n        iconUrl: remote.icon_url,\n        updatedAt: remote.updated_at\n      }\n    };\n  }\n  validateRegistry(registry) {\n    if (!registry.name || !registry.version || !Array.isArray(registry.templates)) {\n      throw new Error(\"Invalid registry format\");\n    }\n    for (const template of registry.templates) {\n      if (!template.id || !template.name || !template.compose_url) {\n        throw new Error(`Invalid template format: ${template.id}`);\n      }\n    }\n  }\n  clearCache() {\n    this.cache.clear();\n  }\n}\nconst templateRegistryService = new TemplateRegistryService();\nexport {\n  templateRegistryService as t\n};\n"],"names":[],"mappings":"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"}